(this["webpackJsonpmy-blog"]=this["webpackJsonpmy-blog"]||[]).push([[0],{33:function(n,t,e){},45:function(n,t,e){"use strict";e.r(t);var r,a,c,i,o,s,d,b=e(0),j=e(22),u=e.n(j),p=(e(33),e(4)),x=e(2),l=e(3),O=e(8),h=e(5),f=Object(b.createContext)(null),g=Object(b.createContext)(null),v="token",m=function(n){localStorage.setItem(v,n)},w=function(){return localStorage.getItem(v)},y="https://student-json-api.lidemy.me",S=function(){return fetch("".concat(y,"/posts?_sort=createdAt&_order=desc")).then((function(n){return n.json()}))},k=function(n){return fetch("".concat(y,"/posts/").concat(n,"?_expand=user")).then((function(n){return n.json()}))},C=function(n,t){return fetch("".concat(y,"/posts?_sort=createdAt&_order=desc&_expand=user&_page=").concat(t,"&_limit=").concat(n)).then((function(n){return n.json()}))},z=function(){var n=w();return fetch("".concat(y,"/me"),{headers:{authorization:"Bearer ".concat(n)}}).then((function(n){return n.json()}))},L=e(1),P=l.a.div(r||(r=Object(x.a)(["\n  width: 80%;\n  min-height: 1000px;\n  margin: 0 auto;\n  background: white;\n"]))),E=l.a.div(a||(a=Object(x.a)(["\n  font-size: 48px;\n  position: absolute;\n  color: #adadad;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n"])));function I(){return Object(L.jsx)(P,{children:Object(L.jsx)(E,{children:"Loading..."})})}var _,D,T,$,U,A=l.a.div(c||(c=Object(x.a)(["\n  color: red;\n"]))),J=l.a.div(i||(i=Object(x.a)(["\n  width: 30%;\n  margin: 0 auto;\n  border: 1px solid #444444;\n  margin-top: 60px;\n  border-radius: 6px;\n  padding: 60px;\n  box-shadow: rgba(0, 0, 0, 0.3) 0px 5px 15px;\n  text-align: center;\n  color: #444444;\n\n  & input {\n    padding: 6px;\n  }\n"]))),B=l.a.div(o||(o=Object(x.a)(["\n  font-size: 26px;\n"]))),F=l.a.div(s||(s=Object(x.a)(["\n  margin: 26px;\n"]))),N=l.a.button(d||(d=Object(x.a)(["\n  padding: 10px;\n  margin-top: 20px;\n  margin: 0 auto;\n  display: flex;\n  cursor: pointer;\n  background: #dddddd;\n  border: 1px solid #444444;\n  border-radius: 3px;\n"])));function M(){var n=Object(b.useContext)(f).setUser,t=Object(b.useState)(""),e=Object(p.a)(t,2),r=e[0],a=e[1],c=Object(b.useState)(""),i=Object(p.a)(c,2),o=i[0],s=i[1],d=Object(b.useState)(""),j=Object(p.a)(d,2),u=j[0],x=j[1],l=Object(b.useState)(),O=Object(p.a)(l,2),g=O[0],v=O[1],w=Object(h.f)();return Object(L.jsx)("form",{onSubmit:function(t){t.preventDefault(),function(n,t,e){return fetch("".concat(y,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:n,username:t,password:e})}).then((function(n){return n.json()}))}(u,r,o).then((function(t){if(0===t.ok)return v(t.message);m(t.token),z().then((function(t){if(1!==t.ok)return m(null),v(t.toString());n(t.data),w.push("/")}))}))},children:Object(L.jsxs)(J,{children:[Object(L.jsx)(B,{children:"\u8a3b\u518a"}),Object(L.jsxs)(F,{children:["Username:"," ",Object(L.jsx)("input",{value:r,onChange:function(n){return a(n.target.value)}})]}),Object(L.jsxs)(F,{children:["Password :"," ",Object(L.jsx)("input",{type:"password",value:o,onChange:function(n){return s(n.target.value)}})]}),Object(L.jsxs)(F,{children:["Nickname:"," ",Object(L.jsx)("input",{value:u,onChange:function(n){return x(n.target.value)}})]}),Object(L.jsx)(N,{type:"submit",children:"\u8a3b\u518a"}),g&&Object(L.jsx)(A,{children:g})]})})}var q=l.a.div(_||(_=Object(x.a)(["\n  color: red;\n"]))),G=l.a.div(D||(D=Object(x.a)(["\n  width: 30%;\n  margin: 0 auto;\n  border: 1px solid #444444;\n  margin-top: 60px;\n  border-radius: 6px;\n  padding: 60px;\n  box-shadow: rgba(0, 0, 0, 0.3) 0px 5px 15px;\n  text-align: center;\n  color: #444444;\n\n  & input {\n    padding: 6px;\n  }\n"]))),H=l.a.div(T||(T=Object(x.a)(["\n  font-size: 26px;\n"]))),K=l.a.button($||($=Object(x.a)(["\n  padding: 10px;\n  margin-top: 20px;\n  margin: 0 auto;\n  display: flex;\n  cursor: pointer;\n  background: #dddddd;\n  border: 1px solid #444444;\n  border-radius: 3px;\n"]))),Q=l.a.div(U||(U=Object(x.a)(["\n  margin: 26px;\n"])));function R(){var n=Object(b.useContext)(f).setUser,t=Object(b.useState)(""),e=Object(p.a)(t,2),r=e[0],a=e[1],c=Object(b.useState)(""),i=Object(p.a)(c,2),o=i[0],s=i[1],d=Object(b.useState)(),j=Object(p.a)(d,2),u=j[0],x=j[1],l=Object(h.f)();return Object(L.jsx)("form",{onSubmit:function(t){t.preventDefault(),function(n,t){return fetch("".concat(y,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:n,password:t})}).then((function(n){return n.json()}))}(r,o).then((function(t){0===t.ok&&x(t.message),m(t.token),z().then((function(t){if(1!==t.ok)return m(null),x(t.toString());n(t.data),l.push("/")}))}))},children:Object(L.jsxs)(G,{children:[Object(L.jsx)(H,{children:"\u767b\u5165"}),Object(L.jsxs)(Q,{children:["Username:"," ",Object(L.jsx)("input",{value:r,onChange:function(n){return a(n.target.value)}})]}),Object(L.jsxs)(Q,{children:["Password :"," ",Object(L.jsx)("input",{type:"password",value:o,onChange:function(n){return s(n.target.value)}})]}),Object(L.jsx)(K,{type:"submit",children:"\u767b\u5165"}),u&&Object(L.jsx)(q,{children:u})]})})}var V,W,X,Y,Z=e(11),nn=e.n(Z),tn=e(13),en=e(28),rn=e.n(en),an=l.a.div(V||(V=Object(x.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]))),cn=Object(l.a)(O.b)(W||(W=Object(x.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n"]))),on=l.a.div(X||(X=Object(x.a)(["\n  color: #888888;\n"])));function sn(n){var t=n.post;return Object(L.jsxs)(an,{children:[Object(L.jsx)(cn,{to:"/posts/".concat(t.id),children:t.title}),Object(L.jsx)(on,{children:new Date(t.createdAt).toLocaleString()})]})}var dn,bn,jn,un,pn,xn=l.a.div(Y||(Y=Object(x.a)(["\n  width: 80%;\n  margin: 0 auto;\n"])));function ln(){var n=Object(b.useState)([]),t=Object(p.a)(n,2),e=t[0],r=t[1],a=Object(b.useContext)(g).setIsLoading;return Object(b.useEffect)((function(){var n=function(){var n=Object(tn.a)(nn.a.mark((function n(){var t;return nn.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a(!0),n.next=3,S();case 3:t=n.sent,r(t),a(!1);case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}),[a]),Object(L.jsx)(xn,{children:e.map((function(n){return Object(L.jsx)(sn,{post:n},n.id)}))})}sn.propTypes={post:rn.a.object};var On,hn,fn,gn,vn,mn,wn,yn,Sn,kn=l.a.div(dn||(dn=Object(x.a)(["\n  height: 64px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0 32px;\n  box-sizing: border-box;\n  background: white;\n"]))),Cn=l.a.div(bn||(bn=Object(x.a)(["\n  font-size: 32px;\n  font-weight: bold;\n"]))),zn=l.a.div(jn||(jn=Object(x.a)(["\n  display: flex;\n  align-items: center;\n  height: 64px;\n"]))),Ln=Object(l.a)(O.b)(un||(un=Object(x.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizeing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n\n  ","\n"])),(function(n){return n.$active&&"background: rgba(0, 0, 0, 0.2)"})),Pn=l.a.div(pn||(pn=Object(x.a)(["\n  display: flex;\n  align-items: center;\n\n  "," {\n    margin-left: 64px;\n  }\n"])),zn);function En(){var n=Object(h.g)(),t=Object(h.f)(),e=Object(b.useContext)(f),r=e.user,a=e.setUser;return Object(L.jsxs)(kn,{children:[Object(L.jsxs)(Pn,{children:[Object(L.jsx)(Cn,{children:"\u4ec0\u9ebc\u90fd\u6709\u7684\u90e8\u843d\u683c"}),Object(L.jsxs)(zn,{children:[Object(L.jsx)(Ln,{to:"/",$active:"/"===n.pathname,children:"\u9996\u9801"}),Object(L.jsx)(Ln,{to:"/list",$active:"/list"===n.pathname,children:"\u6587\u7ae0\u5217\u8868"}),Object(L.jsx)(Ln,{to:"/about",$active:"/about"===n.pathname,children:"About"}),r&&Object(L.jsx)(Ln,{to:"/new-post",$active:"/new-post"===n.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(L.jsxs)(zn,{children:[!r&&Object(L.jsx)(Ln,{to:"/login",$active:"/login"===n.pathname,children:"\u767b\u5165"}),!r&&Object(L.jsx)(Ln,{to:"/register",$active:"/register"===n.pathname,children:"\u8a3b\u518a"}),r&&Object(L.jsx)(Ln,{onClick:function(){m(""),a(null),"/"!==n.pathname&&t.push("/")},children:"\u767b\u51fa"})]})]})}var In,_n,Dn,Tn,$n,Un,An=l.a.div(On||(On=Object(x.a)(["\n  width: 60%;\n  margin: 0 auto;\n  border: 1px solid #444444;\n  margin-top: 60px;\n  border-radius: 6px;\n  padding: 40px;\n  box-shadow: rgba(0, 0, 0, 0.3) 0px 5px 15px;\n  position: relative;\n"]))),Jn=l.a.h1(hn||(hn=Object(x.a)(["\n  color: #666666;\n"]))),Bn=l.a.div(fn||(fn=Object(x.a)(["\n  font-size: 20px;\n  word-wrap: break-word;\n  word-break: break-all;\n  border-bottom: 1px solid #444444;\n  padding: 20px;\n"]))),Fn=l.a.div(gn||(gn=Object(x.a)(["\n  margin-top: 28px;\n  position: absolute;\n  right: 20px;\n  bottom: 16px;\n"]))),Nn=l.a.button(vn||(vn=Object(x.a)(["\n  border: 1px solid #444444;\n  padding: 16px;\n  text-decoration: none;\n  border-radius: 6px;\n  color: #444444;\n  cursor: pointer;\n"]))),Mn=Object(l.a)(O.b)(mn||(mn=Object(x.a)(["\n  padding: 12px;\n  text-decoration: none;\n  color: #444444;\n"]))),qn=l.a.div(wn||(wn=Object(x.a)([""]))),Gn=l.a.div(yn||(yn=Object(x.a)([""]))),Hn=l.a.div(Sn||(Sn=Object(x.a)(["\n  padding: 20px;\n  color: #888888;\n"])));function Kn(){var n=Object(h.h)().id,t=Object(b.useContext)(g).setIsLoading,e=Object(b.useContext)(f).user,r=Object(b.useState)([]),a=Object(p.a)(r,2),c=a[0],i=a[1],o=Object(b.useState)(),s=Object(p.a)(o,2),d=s[0],j=s[1],u=Object(h.f)();Object(b.useEffect)((function(){var e=function(){var e=Object(tn.a)(nn.a.mark((function e(){var r;return nn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(!0),e.next=3,k(n);case 3:r=e.sent,i(r),j(r.user),t(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t,n]);return Object(L.jsxs)(An,{children:[Object(L.jsx)(Jn,{children:c.title}),Object(L.jsx)(Bn,{children:c.body}),Object(L.jsxs)(Hn,{children:[Object(L.jsxs)(qn,{children:["\u6587\u7ae0\u4f5c\u8005\uff1a",d&&d.nickname]}),Object(L.jsxs)(Gn,{children:["\u767c\u5e03\u6642\u9593\uff1a",new Date(c.createdAt).toLocaleString()]})]}),Object(L.jsx)(Fn,{children:e&&d&&e.username===d.username?Object(L.jsx)(Nn,{onClick:function(){(function(n){return fetch("".concat(y,"/posts/").concat(n),{method:"DELETE"}).then((function(n){return n.json()}))})(n).then((function(){u.push("/list")}))},children:"\u522a\u9664\u6587\u7ae0"}):Object(L.jsx)(Mn,{to:"/",children:"\u56de\u5230\u9996\u9801"})})]})}var Qn,Rn,Vn,Wn,Xn,Yn,Zn=l.a.div(In||(In=Object(x.a)(["\n  width: 60%;\n  margin: 0 auto;\n  border: 1px solid #444444;\n  margin-top: 60px;\n  border-radius: 6px;\n  padding: 60px;\n  box-shadow: rgba(0, 0, 0, 0.3) 0px 5px 15px;\n  position: relative;\n"]))),nt=l.a.div(_n||(_n=Object(x.a)(["\n  position: absolute;\n  right: 60px;\n  bottom: 16px;\n"]))),tt=l.a.button(Dn||(Dn=Object(x.a)(["\n  cursor: pointer;\n"]))),et=l.a.span(Tn||(Tn=Object(x.a)(["\n  font-size: 20px;\n  height: 30px;\n  margin-left: 4px;\n  padding: 6px;\n"]))),rt=l.a.button($n||($n=Object(x.a)(["\n  margin-left: 4px;\n  cursor: pointer;\n"]))),at=l.a.div(Un||(Un=Object(x.a)(["\n  font-size: 16px;\n"])));function ct(){var n=Object(b.useContext)(g).setIsLoading,t=Object(b.useState)([]),e=Object(p.a)(t,2),r=e[0],a=e[1],c=Object(b.useState)(1),i=Object(p.a)(c,2),o=i[0],s=i[1],d=Object(b.useState)(0),j=Object(p.a)(d,2),u=j[0],x=j[1];Object(b.useEffect)((function(){var t=function(){var t=Object(tn.a)(nn.a.mark((function t(){var e,r;return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(!0),t.next=3,C(5,o);case 3:return e=t.sent,a(e),t.next=7,S();case 7:r=t.sent,x(Math.ceil((r.length-1)/5)),n(!1);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[n,o,u]);return Object(L.jsxs)(Zn,{children:[r.map((function(n){return Object(L.jsx)(sn,{post:n},n.id)})),Object(L.jsxs)(at,{children:["\u76ee\u524d\u7e3d\u5171\u6709\uff1a ",u," \u9801"]}),Object(L.jsxs)(nt,{children:[Object(L.jsx)(tt,{onClick:function(){o>1&&s(o-1)},children:"\uff1c"}),Object(L.jsx)(et,{children:o}),Object(L.jsx)(rt,{onClick:function(){o<=u&&s(o+1)},children:"\uff1e"})]})]})}var it,ot,st,dt,bt=l.a.div(Qn||(Qn=Object(x.a)(["\n  width: 60%;\n  margin: 0 auto;\n  border: 1px solid #444444;\n  margin-top: 60px;\n  border-radius: 6px;\n  padding: 40px;\n  box-shadow: rgba(0, 0, 0, 0.3) 0px 5px 15px;\n  position: relative;\n"]))),jt=l.a.h1(Rn||(Rn=Object(x.a)(["\n  color: #666666;\n"]))),ut=l.a.input(Vn||(Vn=Object(x.a)(["\n  font-size: 18px;\n  border: 1px solid #444444;\n  border-radius: 3px;\n  padding: 10px;\n"]))),pt=l.a.textarea(Wn||(Wn=Object(x.a)(["\n  font-size: 18px;\n  margin-top: 10px;\n  padding: 10px;\n  border: 1px solid #444444;\n  border-radius: 3px;\n  word-wrap: break-word;\n  word-break: break-all;\n"]))),xt=l.a.button(Xn||(Xn=Object(x.a)(["\n  margin-top: 28px;\n  position: absolute;\n  right: 20px;\n  bottom: 16px;\n  border: none;\n  background: white;\n  cursor: pointer;\n  font-size: 18px;\n"]))),lt=l.a.div(Yn||(Yn=Object(x.a)(["\n  color: red;\n"])));function Ot(){var n=Object(b.useState)(""),t=Object(p.a)(n,2),e=t[0],r=t[1],a=Object(b.useState)(""),c=Object(p.a)(a,2),i=c[0],o=c[1],s=Object(b.useState)(null),d=Object(p.a)(s,2),j=d[0],u=d[1],x=Object(h.f)();return Object(L.jsx)("form",{onSubmit:function(n){n.preventDefault();var t=w();if(t){if(!e||!i)return u("\u6a19\u984c\u53ca\u5167\u5bb9\u4e0d\u5f97\u70ba\u7a7a");!function(n,t,e){fetch("".concat(y,"/posts"),{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer ".concat(n)},body:JSON.stringify({title:t,body:e})}).then((function(n){return n.json()}))}(t,e,i),x.push("/list")}},children:Object(L.jsxs)(bt,{children:[Object(L.jsx)(jt,{children:"\u767c\u5e03\u65b0\u6587\u7ae0"}),Object(L.jsx)("div",{children:Object(L.jsx)(ut,{value:e,onChange:function(n){return r(n.target.value)},type:"text",name:"title",placeholder:"\u6587\u7ae0\u6a19\u984c"})}),Object(L.jsx)("div",{children:Object(L.jsx)(pt,{value:i,onChange:function(n){return o(n.target.value)},type:"textarea",name:"content",placeholder:"\u6587\u7ae0\u5167\u5bb9",rows:5,cols:100})}),Object(L.jsx)(xt,{type:"submit",children:"\u767c\u5e03"}),j&&Object(L.jsx)(lt,{children:j})]})})}var ht,ft=l.a.div(it||(it=Object(x.a)(["\n  width: 40%;\n  margin: 0 auto;\n  margin-top: 60px;\n  border: 1px solid #444444;\n  border-radius: 6px;\n  padding: 60px;\n  box-shadow: rgba(0, 0, 0, 0.3) 0px 5px 15px;\n  position: relative;\n"]))),gt=l.a.div(ot||(ot=Object(x.a)(["\n  font-size: 18px;\n  text-align: center;\n"]))),vt=Object(l.a)(O.b)(st||(st=Object(x.a)(["\n  padding: 12px;\n  text-decoration: none;\n  color: #666666;\n  position: absolute;\n  right: 6px;\n  bottom: 6px;\n"]))),mt=l.a.h1(dt||(dt=Object(x.a)(["\n  text-align: center;\n"])));function wt(){return Object(L.jsxs)(ft,{children:[Object(L.jsx)(mt,{children:"\u6b61\u8fce\u52a0\u5165\u6211\u5011\uff01"}),Object(L.jsxs)(gt,{children:["\u5728\u9019\u908a\u4f60\u53ef\u4ee5\u770b\u5230\u4e0d\u540c\u4f5c\u8005\u5beb\u7684\u6587\u7ae0",Object(L.jsx)("br",{}),"\u4f60\u4e5f\u60f3\u8981\u767c\u8868\u81ea\u5df1\u7684\u60f3\u6cd5\u4ee5\u53ca\u610f\u898b\u55ce\uff1f",Object(L.jsx)("br",{}),"\u6b61\u8fce\u8a3b\u518a\u6210\u70ba\u6211\u5011\u7684\u4e00\u4efd\u5b50\uff01"]}),Object(L.jsx)(vt,{to:"/",children:"\u56de\u5230\u9996\u9801"})]})}var yt=l.a.div(ht||(ht=Object(x.a)(["\n  padding-top: 64px;\n"])));var St=function(){var n=Object(b.useState)(null),t=Object(p.a)(n,2),e=t[0],r=t[1],a=Object(b.useState)(!0),c=Object(p.a)(a,2),i=c[0],o=c[1];return Object(b.useEffect)((function(){w()&&z().then((function(n){n.ok&&r(n.data)}))}),[]),Object(L.jsx)(f.Provider,{value:{user:e,setUser:r},children:Object(L.jsx)(g.Provider,{value:{isLoading:i,setIsLoading:o},children:Object(L.jsx)(yt,{children:Object(L.jsxs)(O.a,{children:[Object(L.jsx)(En,{}),i&&Object(L.jsx)(I,{}),Object(L.jsxs)(h.c,{children:[Object(L.jsx)(h.a,{exact:!0,path:"/",children:Object(L.jsx)(ln,{})}),Object(L.jsx)(h.a,{path:"/login",children:Object(L.jsx)(R,{})}),Object(L.jsx)(h.a,{path:"/posts/:id",children:Object(L.jsx)(Kn,{})}),Object(L.jsx)(h.a,{path:"/list",children:Object(L.jsx)(ct,{})}),Object(L.jsx)(h.a,{path:"/register",children:Object(L.jsx)(M,{})}),Object(L.jsx)(h.a,{path:"/new-post",children:Object(L.jsx)(Ot,{})}),Object(L.jsx)(h.a,{path:"/about",children:Object(L.jsx)(wt,{})})]})]})})})})},kt=function(n){n&&n instanceof Function&&e.e(3).then(e.bind(null,46)).then((function(t){var e=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;e(n),r(n),a(n),c(n),i(n)}))};u.a.render(Object(L.jsx)(St,{}),document.getElementById("root")),kt()}},[[45,1,2]]]);
//# sourceMappingURL=main.654f9096.chunk.js.map